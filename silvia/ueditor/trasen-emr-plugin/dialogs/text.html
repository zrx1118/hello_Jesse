<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>文本域</title>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.css">
    <!--[if lte IE 6]>
    <link rel="stylesheet" type="text/css" href="../bootstrap/css/bootstrap-ie6.css">
    <![endif]-->
    <!--[if lte IE 7]>
    <link rel="stylesheet" type="text/css" href="../bootstrap/css/ie.css">
    <![endif]-->
  <link rel="stylesheet" href="../css/leipi.style.css">
  <script type="text/javascript" src="../../dialogs/internal.js"></script>
    <script type="text/javascript">

      function createElement(type, name)
      {
          var element = null;
          try {
              element = document.createElement('<'+type+' name="'+name+'">');
          } catch (e) {}
          if(element==null) {
              element = document.createElement(type);
              element.name = name;
          }
          return element;
      }
    </script>
</head>
<body>
<div class="content">
    <table class="table table-bordered table-striped table-hover">
     <tr>
        <th><span>控件名称</span><span class="label label-important">*</span></th>
        <th><span>默认值</span> </th>
    </tr>
    <tr>
        <td><input type="text" id="orgname" placeholder="必填项"></td>
        <td><input type="text" id="orgvalue" placeholder="无则不填"></td>
    </tr>
    <tr>
        <th><span>数据类型</span> </th>
        <th><span>对齐方式</span> </th>
    </tr>
    <tr>
        <td>
             <select id="orgtype">
                <option value="text">普通文本</option>
                <option value="email">邮箱地址</option>
                <option value="int">整数</option>
                <option value="float">小数</option>
                <option value="idcard">身份证号码</option>
            </select>
        </td>
        <td>
            <select id="orgalign">
                <option value="left" >左对齐</option>
                <option value="center">居中对齐</option>
                <option value="right">右对齐</option>
            </select>
        </td>
    </tr>
    <tr>
        <th><span>&nbsp;&nbsp;&nbsp;&nbsp;长&nbsp;&nbsp;X&nbsp;&nbsp;宽&nbsp;&nbsp;&nbsp;&&nbsp;&nbsp;&nbsp;字体大小</span> </th>
        <th><span>可见性</span> </th>
    </tr>
    <tr>
        <td>
            <input id="orgwidth" type="text" value="150" class="input-small span1" placeholder="auto"/>
            X
            <input id="orgheight" type="text" value="" class="input-small span1" placeholder="auto"/>
            &
            <input id="orgfontsize" type="text"  value="" class="input-small span1" placeholder="auto"/> px

        </td>
        <td>
            <label class="checkbox inline"><input id="orghide" type="checkbox"/> 隐藏 </label>
        </td>
    </tr>

    </table>
</div>
<script type="text/javascript">
var oNode = null,thePlugins = 'emr_text';
window.onload = function() {
    if( UE.plugins[thePlugins].editdom ){
        oNode = UE.plugins[thePlugins].editdom;
		    //TODO:编辑时数据回填
        $G('orgname').value = oNode.getAttribute('emr-bgtext');
    }
}
dialog.oncancel = function () {
    if( UE.plugins[thePlugins].editdom ) {
        delete UE.plugins[thePlugins].editdom;
    }
};
dialog.onok = function (){
  if($G('orgname').value==''){
      alert('请输入控件名称');
      return false;
  }

  if(oNode ){
    domUtils.remove(oNode,false);  //删除当前控件，再创建一个新的
    delete UE.plugins[thePlugins].editdom;
  }
  editor.execCommand('insertHtml',getNewDom().outerHTML);
};
/**
 * dom对象获取
 * 根据界面设置，创建新dom节点
 */
getNewDom = function () {
  var orgname = $G('orgname').value;
  var node = createElement('span');
  node.setAttribute('class', 'input_text_box not_edited');
  node.setAttribute('emr-plugins', 'emrFieldElement');
  node.setAttribute('emr-type', 'emr_text');
  node.setAttribute('emr-field', '');
  node.setAttribute('emr-value', '');
  node.setAttribute('emr-bgtext', orgname);
  node.setAttribute('emr-deleteable', 'false');
  node.setAttribute('emr-editable', 'true');
  node.setAttribute('emr-edited', 'false');
  node.setAttribute('emr-events', 'click|change');

  var childNode1 = createElement('em');
  childNode1.setAttribute('emr-ignore', '1');
  childNode1.innerHTML = '[';
  childNode1.setAttribute('contenteditable', 'false');
  node.appendChild(childNode1);

  var childNode2 = createElement('label');
  childNode2.setAttribute('emr-type', 'bgtext');
  childNode2.setAttribute('contenteditable', 'false');
  childNode2.innerHTML = orgname;
  node.appendChild(childNode2);

  var childNode3 = createElement('em');
  childNode3.setAttribute('emr-ignore', '1');
  childNode3.innerHTML = ']';
  childNode3.setAttribute('contenteditable', 'false');
  node.appendChild(childNode3);

  return node;
}
</script>
</body>
</html>
